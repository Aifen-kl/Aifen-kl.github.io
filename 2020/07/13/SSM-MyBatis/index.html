
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SSM-MyBatis | 秃头日记</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="">
    <meta name="description" content="SSM-MyBatis1.简介1.1 什么是mybatis

MyBatis前身是iBatis T本是Apache的一个开源的项目

官方网站



ORM框架

实体类和SQL语句之间建 立映射关系

特点

基于SQL语法,简单易学
能了解底层封装过程
SQL语句封装在配置文件中, 便于统一管理与维护,降低程序的耦合度
方便程序代码调试




如何获取mybatis？


maven仓库 
123456&amp;lt;!-- https ://mvnreposi tory. com/artifact/org. mybatis/mybatis --&amp;gt;&amp;lt;dependency&amp;gt;&amp;lt;groupId&amp;gt;or...">
    
        <link rel="icon" href="/favicon.ico">
    
    
        
            <link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
        
            <link rel="stylesheet" href="/css/stage.css">
        
            <link rel="stylesheet" href="/css/avatar-bg.css">
        
    
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
<header id="header">
    <div class="menu">
        <i class="fa fa-bars"></i>
    </div>
    <div class="header-main">
        <h1><a href="/">秃头日记</a></h1>
    </div>
    <div id="nav">
        <div class="nav-img" id="nav-img"></div>
        <div class="sentences">
            How goes the world with you?
        </div>
    </div>
</header>

<div id="content-outer">
    <div id="content-inner">
        <div class="clearfix">
    <article id="post">
        <h1>SSM-MyBatis</h1>
        <div class="create">
            <span>创建于</span>
            
                <time datetime="2020-07-13T01:19:10.150Z">
                    2020-07-13
                </time>
            
            
        </div>
        <h1 id="SSM-MyBatis"><a href="#SSM-MyBatis" class="headerlink" title="SSM-MyBatis"></a>SSM-MyBatis</h1><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h2><h3 id="1-1-什么是mybatis"><a href="#1-1-什么是mybatis" class="headerlink" title="1.1 什么是mybatis"></a>1.1 什么是mybatis</h3><p><img src="/2020/07/13/SSM-MyBatis/image-20200709111443684.png" alt="image-20200709111443684"></p>
<ul>
<li><p>MyBatis前身是iBatis T本是Apache的一个开源的项目</p>
</li>
<li><p><a href="http://mybatis.org" target="_blank" rel="noopener">官方网站</a></p>
</li>
</ul>
<ul>
<li><p>ORM框架</p>
</li>
<li><p>实体类和SQL语句之间建 立映射关系</p>
</li>
<li><p>特点</p>
<ol>
<li>基于SQL语法,简单易学</li>
<li>能了解底层封装过程</li>
<li>SQL语句封装在配置文件中, 便于统一管理与维护,降低程序的耦合度</li>
<li>方便程序代码调试</li>
</ol>
</li>
</ul>
<blockquote>
<p><strong>如何获取mybatis？</strong></p>
</blockquote>
<ul>
<li><p>maven仓库 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https ://mvnreposi tory. com/artifact/org. mybatis/mybatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis <span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>GitHub  <a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="noopener">点一点</a></p>
</li>
<li><p>中文文档 <a href="https://mybatis.org/mybatis-3/zh/index.html" target="_blank" rel="noopener">点一点</a></p>
</li>
</ul>
<h3 id="1-2-持久化"><a href="#1-2-持久化" class="headerlink" title="1.2 持久化"></a>1.2 持久化</h3><p>数据持久化</p>
<ul>
<li>持久化就是将程序将持久状态和瞬时状态转化的过程</li>
<li>内存：<strong>断电即失</strong></li>
<li>数据库(Jdbc)，io文件持久化</li>
<li>生活：冷藏罐头</li>
</ul>
<p><strong>为什么需要持久化？</strong></p>
<ul>
<li>数据需要，不能丢掉</li>
<li>内存太贵了</li>
</ul>
<h3 id="1-3持久层"><a href="#1-3持久层" class="headerlink" title="1.3持久层"></a>1.3持久层</h3><p>Dao层，Service层，Controller层……</p>
<ul>
<li>完成持久化的代码块</li>
<li>层界十分明显</li>
</ul>
<h2 id="2-第一个Mybatis程序"><a href="#2-第一个Mybatis程序" class="headerlink" title="2.第一个Mybatis程序"></a>2.第一个Mybatis程序</h2><p>思路：搭建环境    导入Mybatis   编写代码</p>
<h3 id="2-1-搭建环境"><a href="#2-1-搭建环境" class="headerlink" title="2.1 搭建环境"></a>2.1 搭建环境</h3><p>搭建数据库</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE `mybatis`;</span><br><span class="line"></span><br><span class="line">USE `mybatis`;</span><br><span class="line"></span><br><span class="line">CREATE TABLE `user`(</span><br><span class="line">`id` INT(<span class="number">20</span>) NOT NULL PRIMARY KEY,</span><br><span class="line">`name` VARCHAR(<span class="number">30</span>) DEFAULT NULL,</span><br><span class="line">`pwd` VARCHAR(<span class="number">30</span>) DEFAULT NULL</span><br><span class="line">)ENGINE=INNODB DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">INSERT INTO `user`(`id`,`name`,`pwd`) VALUES</span><br><span class="line">(<span class="number">1</span>,<span class="string">'狂神1'</span>,<span class="string">'123456'</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">'狂神2'</span>,<span class="string">'123456'</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">'狂神3'</span>,<span class="string">'123456'</span>)</span><br></pre></td></tr></table></figure>

<p>创建项目</p>
<ol>
<li><p>新建一个普通的maven项目</p>
</li>
<li><p>删除src目录</p>
</li>
<li><p>导入maven依赖</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--导入依赖--&gt;</span><br><span class="line">   &lt;dependencies&gt;</span><br><span class="line">       &lt;!--mysql架包--&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;5.1.10&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;!--mybatis--&gt;</span><br><span class="line">       &lt;!-- https :<span class="comment">//mvnreposi tory. com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;3.5.2&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;!--juint--&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;4.12&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">   &lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="2-2-创建一个模块"><a href="#2-2-创建一个模块" class="headerlink" title="2.2 创建一个模块"></a>2.2 创建一个模块</h3><ul>
<li><p>编写mybatis的核心配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding= "UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis .org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http: //mybatis . org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--configuration核心配置文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">""</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写mybatis工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载资源，获取执行SQL的对象</span></span><br><span class="line"><span class="comment">//sqlSessionFactory --&gt; sqlSession</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//使用Mybatis第一步:获取sqlSessionFactory对象</span></span><br><span class="line">            String resource = <span class="string">" mybatis-config . xml"</span>;</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//既然有了SqlSessionFactory, 顾名思义，我们就可以从中获得SqlSession的实例了。</span></span><br><span class="line">    <span class="comment">// SqlSession 完全包含了面向数据库执行SQL命令所需的所有方法。</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="2-3-编写代码"><a href="#2-3-编写代码" class="headerlink" title="2.3 编写代码"></a>2.3 编写代码</h3><ul>
<li><p>实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实体类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", pwd='"</span> + pwd + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> id, String name, String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPwd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPwd</span><span class="params">(String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Dao接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">//查询所有用户信息</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>接口实现类由原来的UserDaoImpl转变为一个Mapper配置文件</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC</span><br><span class="line">        <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line">        <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span><br><span class="line">&lt;!--namespace=绑定一个 对应的Dao/Mapper按口--&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">"com.mkw.dao.UserDao"</span>&gt;</span><br><span class="line">  </span><br><span class="line">    &lt;!--select查询语句  id相当于实现的方法名 resultType相当于返回值类型--&gt; &lt;select id=<span class="string">"getUserList"</span> resultType=<span class="string">"com.mkw.pojo.User"</span>&gt;</span><br><span class="line">    select * from mybatis.user</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">  </span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="2-4-测试"><a href="#2-4-测试" class="headerlink" title="2.4 测试"></a>2.4 测试</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//第一步：获得SqlSession对象</span></span><br><span class="line">       SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//方式一：getMapper</span></span><br><span class="line">       UserDao userDao = sqlSession.getMapper(UserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">       List&lt;User&gt; userList = userDao.getUserList();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//遍历数据</span></span><br><span class="line">       <span class="keyword">for</span> (User user : userList</span><br><span class="line">       ) &#123;</span><br><span class="line">           System.out.println(user);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//关闭SqlSession</span></span><br><span class="line">       sqlSession.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意点!!!可能遇到的问题:</strong></p>
</blockquote>
<ol>
<li><p>配置文件没有注册</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--每一个Mapper.XML都需要在Mybatis核心配置文件中注册!--&gt;</span><br><span class="line">&lt;mappers&gt;</span><br><span class="line">    &lt;mapper resource="com/mkw/dao/UserMapper.xml"&gt;&lt;/mapper&gt;</span><br><span class="line">&lt;/mappers&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>绑定接口错误</p>
</li>
<li><p>方法名不对</p>
</li>
<li><p>返回类型不对</p>
</li>
<li><p>maven导出资源问题（修改pom.xml）</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--在build中配置resources，来防止我们资源导出失败的问题--&gt;</span><br><span class="line">  &lt;build&gt;</span><br><span class="line">      &lt;resources&gt;</span><br><span class="line">          &lt;resource&gt;</span><br><span class="line">              &lt;directory&gt;src/main/resources&lt;/directory&gt;</span><br><span class="line">              &lt;includes&gt;</span><br><span class="line">                  &lt;include&gt;**<span class="comment">/*.properties&lt;/include&gt;</span></span><br><span class="line">                  &lt;include&gt;**/*.xml&lt;/include&gt;</span><br><span class="line">              &lt;/includes&gt;</span><br><span class="line">          &lt;/resource&gt;</span><br><span class="line">          &lt;resource&gt;</span><br><span class="line">              &lt;directory&gt;src/main/java&lt;/directory&gt;</span><br><span class="line">              &lt;includes&gt;</span><br><span class="line">                  &lt;include&gt;**<span class="comment">/*.properties&lt;/include&gt;</span></span><br><span class="line">                  &lt;include&gt;**/*.xml&lt;/include&gt;</span><br><span class="line">              &lt;/includes&gt;</span><br><span class="line">              &lt;filtering&gt;true&lt;/filtering&gt;</span><br><span class="line">          &lt;/resource&gt;</span><br><span class="line">      &lt;/resources&gt;</span><br><span class="line">  &lt;/build&gt;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="3-CRUD"><a href="#3-CRUD" class="headerlink" title="3.CRUD"></a>3.CRUD</h2><h3 id="1-namespace"><a href="#1-namespace" class="headerlink" title="1.namespace"></a>1.namespace</h3><p>namespace中的包名要和Dao/mapper接口的包名一致!</p>
<h3 id="2-select"><a href="#2-select" class="headerlink" title="2.select"></a>2.select</h3><ul>
<li>id：就是对应的namespace中的方法名</li>
<li>resultType：SQL语句执行的返回值</li>
<li>parametertType：参数类型！</li>
</ul>
<blockquote>
<p><strong>流程</strong></p>
</blockquote>
<ol>
<li><p>编写接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询所有用户信息</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line">   </span><br><span class="line"><span class="comment">//根据id查询用户</span></span><br><span class="line"><span class="function">User <span class="title">getUsergetById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li><p>编写对应的mapper中的sql语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--select查询语句  id相当于实现的方法名 </span></span><br><span class="line"><span class="comment">  resultType相当于返回值类型 parameterType参数类型--&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserList"</span> <span class="attr">resultType</span>=<span class="string">"com.mkw.pojo.User"</span>&gt;</span></span><br><span class="line">select * from mybatis.user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUsergetById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"com.mkw.pojo.User"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="3">
<li><p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//第一步：获得SqlSession对象</span></span><br><span class="line"> SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"> <span class="comment">//方式一：getMapper</span></span><br><span class="line"> UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"> <span class="comment">//执行语句</span></span><br><span class="line"> List&lt;User&gt; userList = userMapper.getUserList();</span><br><span class="line"> <span class="comment">//遍历结果</span></span><br><span class="line"><span class="keyword">for</span> (User user : userList)&#123;</span><br><span class="line">  System.out.println(user);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//关闭资源</span></span><br><span class="line"> sqlSession.close();</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="3-insert"><a href="#3-insert" class="headerlink" title="3.insert"></a>3.insert</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--新增,对象的属性可以直接写--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.mkw.pojo.User"</span>&gt;</span></span><br><span class="line">    insert into mybatis.user(id,name,pwd) values(#&#123;id&#125;,#&#123;name&#125;,#&#123;pwd&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-update"><a href="#4-update" class="headerlink" title="4.update"></a>4.update</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--修改--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.mkw.pojo.User"</span>&gt;</span></span><br><span class="line">       update mybatis.user set name = #&#123;name&#125;,pwd = #&#123;pwd&#125; where id = #&#123;id&#125; ;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-delete"><a href="#5-delete" class="headerlink" title="5.delete"></a>5.delete</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--删除--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUser"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">     delete from user where id = #&#123;id&#125;;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意点  **</strong>增删改需要提交事物!!!**</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//提交事物</span></span><br><span class="line">sqlSession.commit();</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="6-分析错误"><a href="#6-分析错误" class="headerlink" title="6.分析错误"></a>6.分析错误</h3><ul>
<li><p>标签不要匹配错误</p>
</li>
<li><p>resource 绑定mapper,需要使用路径!</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--每一个Mapper.XML都需要在Mybatis核心配置文件中注册!--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/mkw/dao/UserMapper.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>程序配置文件必须符合规范!</p>
</li>
<li><p>NullPointerException,没有注册到资源 </p>
</li>
<li><p>输出的xml文件中存在中文乱码问题!</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解决方式一</span></span><br><span class="line">&lt;? xml version=<span class="string">"1.0"</span> encoding=<span class="string">"GBK"</span>?&gt;</span><br><span class="line"><span class="comment">//解决方式二 删掉乱码的字 哈哈哈</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>maven资源没有导出问题!</p>
</li>
</ul>
<h3 id="7-万能Map"><a href="#7-万能Map" class="headerlink" title="7.万能Map"></a>7.万能Map</h3><p>假设,我们的实体类，或者数据库中的表,字段或者参数过多，我们应当考虑使用Map!</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//万能map</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addUser2</span><span class="params">(Map&lt;String,Object&gt; map)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--对象中的属性，可以直接取出来传 递map的key--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser2"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">        insert into mybatis.user(id,name,pwd) values(#&#123;userid&#125;,#&#123;username&#125;,#&#123;userpwd&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Testmap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    Map map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    map.put(<span class="string">"userid"</span>, <span class="number">6</span>);</span><br><span class="line">    map.put(<span class="string">"username"</span>, <span class="string">"看"</span>);</span><br><span class="line">    map.put(<span class="string">"userpwd"</span>, <span class="string">"123"</span>);</span><br><span class="line">    userMapper.addUser2(map);</span><br><span class="line">    sqlSession.commit();</span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>Map传递参数，直接在sq|中取出key即可!                         [parameterType=”map”]</li>
<li>对象传递参数，直接在sq|中取对象的属性即可!              [parameterType=”Object”] .</li>
<li>只有一个基本类型参数的情况下，可以直接在sq|中取到!</li>
<li>多个参数用Map,<strong>或者注解!</strong></li>
</ol>
<h3 id="8-思考题"><a href="#8-思考题" class="headerlink" title="8.思考题"></a>8.思考题</h3><p>模糊查询怎么写?</p>
<p>1.java执行代码的时候，传递通配符% %  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userList = userMapper.getUserList1(<span class="string">"%狂神%"</span>);</span><br></pre></td></tr></table></figure>

<p>2.在sql拼接时使用通配符</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserList1"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span> <span class="attr">resultType</span>=<span class="string">"com.mkw.pojo.User"</span>&gt;</span></span><br><span class="line">    select * from user where name like "%"#&#123;val&#125;"%";</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-配置解析"><a href="#4-配置解析" class="headerlink" title="4. 配置解析"></a>4. 配置解析</h2><h3 id="1-核心配置文件"><a href="#1-核心配置文件" class="headerlink" title="1.核心配置文件"></a>1.核心配置文件</h3><ul>
<li><p>mybatis-config.xml</p>
</li>
<li><p>MyBatis的配置文件包含了会深深影响MyBatis行为的设置和属性信息。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">configuration (配置)</span><br><span class="line">properties (属性)</span><br><span class="line">settings (设置)</span><br><span class="line">typealiases (类型别名)</span><br><span class="line">typeHandlers (类型处理器)</span><br><span class="line">objectfdctory (对象工厂)</span><br><span class="line">plugins (插件)</span><br><span class="line">environments (环境配置)</span><br><span class="line">environment (环境变量)</span><br><span class="line">transactionManager (事务管理器)</span><br><span class="line">datasource (数据源)</span><br><span class="line">databaseIdProvider (数据库厂商标识)</span><br><span class="line">mappers (映射器)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="2-环境配置-environments"><a href="#2-环境配置-environments" class="headerlink" title="2.环境配置(environments )"></a>2.环境配置(environments )</h3><ul>
<li>MyBatis可以配置成适应多种环境</li>
<li><strong>不过要记住:尽管可以配置多个环境，但每个SqlSessionFactory实例只能选择-种环境。</strong></li>
<li>学会使用配置多套运行环境!</li>
<li>Mybatis默认的事务管理器就是IDBC.连接池: POOLED</li>
</ul>
<h3 id="3-属性-properties"><a href="#3-属性-properties" class="headerlink" title="3.属性(properties)"></a>3.属性(properties)</h3><ul>
<li><p>我们可以通过properties属性来实现引用配置文件</p>
</li>
<li><p>这些属性都是可外部配置且可动态替换的;既可以在典型的Java属性文件中配置，</p>
</li>
<li><p>亦可通过properties元素的元素来传递。【db.properties】</p>
</li>
<li><p>编写一个配置文件 </p>
<p>  db.properties</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver=com.mysql.jdbc.Driver</span><br><span class="line">url=jdbc:mysql://localhost:3306/mybatis?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8</span><br><span class="line">username=root</span><br><span class="line">password=</span><br></pre></td></tr></table></figure>
</li>
<li><p>在核心配置文件中映入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--引入外部配置文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span>  //无效 优先使用外部配置文件</span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可以在其中增加一些属性配置</p>
</li>
<li><p>如果两个文件有同一一个字段，优先使用外部配置文件的!</p>
</li>
</ul>
<h3 id="4-类型别名-typeAliases"><a href="#4-类型别名-typeAliases" class="headerlink" title="4.类型别名(typeAliases)"></a>4.类型别名(typeAliases)</h3><ul>
<li><p>类型别名是为Java类型设置一个短的名字。</p>
</li>
<li><p>存在的意义仅在于用来减少类完全限定名的冗余。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--可以给实体类起别名--&gt;</span>  //方式一</span><br><span class="line"> <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.mkw.pojo.User"</span> <span class="attr">alias</span>=<span class="string">"user"</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">//效果 实现接口的resultType只需要指定别名</span><br><span class="line"> <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserList"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line"> select * from mybatis.user</span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>也可以指定一个包名， MyBatis会在包名下面搜索需要的Java Bean,比如:</p>
</li>
<li><p>扫描实体类的包，它的默认别名就为这个类的类名，首字母小写!</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--可以给实体类起别名--&gt;</span>  //方式二    </span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.mkw.pojo.User"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol>
<li><p>在实体类比较少的时候，使用第一种方式。</p>
</li>
<li><p>如果实体类十分多，建议使用第二种。</p>
</li>
<li><p>第一种可以自定义别名，第二种则不行，如果非要改，需要在实体上增加注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Alias</span>(<span class="string">"user"</span>)    <span class="comment">//方式三</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="5-设置"><a href="#5-设置" class="headerlink" title="5.设置"></a>5.设置</h3><p>这是MyBatis中极为重要的调整设置，它们会改变MyBatis的运行时行为。</p>
<p><img src="/2020/07/13/SSM-MyBatis/image-20200712154125322.png" alt="image-20200712154125322"></p>
<p><img src="/2020/07/13/SSM-MyBatis/image-20200712154201746.png" alt="image-20200712154201746"></p>
<h3 id="6-其他配置"><a href="#6-其他配置" class="headerlink" title="6.其他配置"></a>6.其他配置</h3><ul>
<li><a href="https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers" target="_blank" rel="noopener">typeHandlers（类型处理器）</a></li>
<li><a href="https://mybatis.org/mybatis-3/zh/configuration.html#objectFactory" target="_blank" rel="noopener">objectFactory（对象工厂）</a></li>
<li>plugins插件 (简化框架)<ol>
<li>mybatis-generator-core</li>
<li>mybatis-plus</li>
<li>通用mapper</li>
</ol>
</li>
</ul>
<h3 id="7-映射器-mappers"><a href="#7-映射器-mappers" class="headerlink" title="7.映射器(mappers)"></a>7.映射器(mappers)</h3><p>MapperRegistry:注册绑定我们的Mapper文件;</p>
<p>方式一:[推荐使用]</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--每一个Mapper.XML都需要在Mybatis核心配置文件中注册!--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/mkw/dao/UserMapper.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>方式二:使用class文件绑定注册</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--每一个Mapper.XML都需要在Mybatis核心配置文件中注册!--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.mkw.dao.UserMapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意点：</p>
<ul>
<li>接口和他的Mapper配置文件必须同名!</li>
<li>接口和他的Mapper配置文件必须在同一个包下!</li>
</ul>
<p>方式三：使用扫描包进行注入绑定</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--每一个Mapper.XML都需要在Mybatis核心配置文件中注册!--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.mkw.dao"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意点：</p>
<ul>
<li>接口和他的Mapper配置文件必须同名! </li>
<li>接口和他的Mapper配置文件必须在同一个包下!</li>
</ul>
<h3 id="8-生命周期和作用域"><a href="#8-生命周期和作用域" class="headerlink" title="8.生命周期和作用域"></a>8.生命周期和作用域</h3><p>生命周期，和作用域，是至关重要的，因为错误的使用会导致非常严重的<strong>并发问题</strong>。</p>
<p><img src="/2020/07/13/SSM-MyBatis/image-20200712165200284.png" alt="image-20200712165200284"></p>
<p><strong>1.SqlSessionFactoryBulider</strong>:</p>
<ul>
<li>一旦创建了SqISessionFactory,就不再需要它了</li>
<li>局部变量</li>
</ul>
<p><strong>2. SqlSessionFactory</strong></p>
<ul>
<li>可以比喻成连接池</li>
<li>SqISessionFactory -旦被创建就应该在应用的运行期间一直存在，<strong>没有任何理由丢弃它或重新创建</strong><br><strong>另一个实例。</strong></li>
<li>因此SqISessionFactory的最佳作用域是应用作用域。</li>
<li>最简单的就是使用单例模式或者静态单例模式。</li>
</ul>
<p><strong>3.SqlSession</strong></p>
<ul>
<li>连接到连接池的一个请求！</li>
<li>SqISession的实例不是线程安全的，因此是不能被共享的,所以它的最佳的作用域是请求或方法作用<br>域。</li>
<li>用完之后需要赶紧关闭，否则资源被占用!</li>
</ul>
<p><img src="/2020/07/13/SSM-MyBatis/image-20200712165023352.png" alt="image-20200712165023352"></p>
<p>这里的每一个Mapper，就代表一个具体的业务！</p>
<h2 id="5-解决属性名和字段名不一致的问题"><a href="#5-解决属性名和字段名不一致的问题" class="headerlink" title="5.解决属性名和字段名不一致的问题"></a>5.解决属性名和字段名不一致的问题</h2><h3 id="1-问题"><a href="#1-问题" class="headerlink" title="1.问题"></a>1.问题</h3><p>数据库的字段</p>
<p><img src="/2020/07/13/SSM-MyBatis/image-20200712171455664.png" alt="image-20200712171455664"></p>
<p>新建一个项目，拷贝之前的，测试实体类字段不-致的情况</p>
<p><img src="/2020/07/13/SSM-MyBatis/image-20200712171535406.png" alt="image-20200712171535406"></p>
<p>运行测试</p>
<p><img src="/2020/07/13/SSM-MyBatis/image-20200712171658210.png" alt="image-20200712171658210"></p>
<p>解决方式：</p>
<ul>
<li>起别名</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUsergetById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"com.mkw.pojo.User"</span>&gt;</span></span><br><span class="line">  select id ,name,pwd as password from mybatis.user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-resultMap"><a href="#2-resultMap" class="headerlink" title="2.resultMap"></a>2.resultMap</h3><p>结果集映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id   name    pwd</span><br><span class="line">id   name    password</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--结果集映射--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"UserMap"</span> <span class="attr">type</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--column数据库中的字段 property实体类的属性--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pwd"</span> <span class="attr">property</span>=<span class="string">"password"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUsergetById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"UserMap"</span>&gt;</span></span><br><span class="line">  select * from mybatis.user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>resu1tMap元素是MyBatis中最重要最强大的元素</li>
<li>ResultMap的设计思想是，对于简单的语句根本不需要配置显式的结果映射，而对于复杂- -点的语句只需要描述它们的关系就行了。</li>
<li>ResultMap最优秀的地方在于，虽然你已经对它相当了解了，但是根本就不需要显式地用到他们。</li>
<li>如果世界总是这么简单就好了。</li>
</ul>

        <div>
            
        </div>
        <div class="bottom-line"></div>
        
    <nav id="article-nav">
        
        
            <a href="/2020/07/05/GitHub%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" id="article-nav-older" class="article-nav-link-wrap">
                <strong class="article-nav-caption">&lt;</strong>
                <span class="article-nav-title">
                    
                        GitHub搭建博客
                </span>
                
            </a>
        
    </nav>


        
    </article>
    <div id="toc">
        
            <h2>文章目录</h2>
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SSM-MyBatis"><span class="toc-number">1.</span> <span class="toc-text">SSM-MyBatis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-简介"><span class="toc-number">1.1.</span> <span class="toc-text">1.简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-什么是mybatis"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 什么是mybatis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-持久化"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 持久化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3持久层"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3持久层</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-第一个Mybatis程序"><span class="toc-number">1.2.</span> <span class="toc-text">2.第一个Mybatis程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-搭建环境"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 搭建环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-创建一个模块"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 创建一个模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-编写代码"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 编写代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-测试"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-CRUD"><span class="toc-number">1.3.</span> <span class="toc-text">3.CRUD</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-namespace"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.namespace</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-select"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.select</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-insert"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.insert</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-update"><span class="toc-number">1.3.4.</span> <span class="toc-text">4.update</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-delete"><span class="toc-number">1.3.5.</span> <span class="toc-text">5.delete</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-分析错误"><span class="toc-number">1.3.6.</span> <span class="toc-text">6.分析错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-万能Map"><span class="toc-number">1.3.7.</span> <span class="toc-text">7.万能Map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-思考题"><span class="toc-number">1.3.8.</span> <span class="toc-text">8.思考题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-配置解析"><span class="toc-number">1.4.</span> <span class="toc-text">4. 配置解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-核心配置文件"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.核心配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-环境配置-environments"><span class="toc-number">1.4.2.</span> <span class="toc-text">2.环境配置(environments )</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-属性-properties"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.属性(properties)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-类型别名-typeAliases"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.类型别名(typeAliases)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-设置"><span class="toc-number">1.4.5.</span> <span class="toc-text">5.设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-其他配置"><span class="toc-number">1.4.6.</span> <span class="toc-text">6.其他配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-映射器-mappers"><span class="toc-number">1.4.7.</span> <span class="toc-text">7.映射器(mappers)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-生命周期和作用域"><span class="toc-number">1.4.8.</span> <span class="toc-text">8.生命周期和作用域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-解决属性名和字段名不一致的问题"><span class="toc-number">1.5.</span> <span class="toc-text">5.解决属性名和字段名不一致的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-问题"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-resultMap"><span class="toc-number">1.5.2.</span> <span class="toc-text">2.resultMap</span></a></li></ol></li></ol></li></ol>
        
    </div>
</div>

    </div>
</div>
<footer id="footer">
    <div id="copyright">&copy; Aifen-kl  2020</div>
    <div id="theme">
        Powered by <a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a>. Theme by <a href="https://github.com/markyong/hexo-theme-stage" target="_blank" rel="noopener">Stage</a>
    </div>
</footer>
<script src="/lib/js/waterrippleeffect.min.js"></script>
<script src="/js/header-bg.main.js"></script>

    <script src="/lib/js/smooth-scroll.min.js"></script>
    <script src="/js/toc.main.js"></script>

</body>
</html>
